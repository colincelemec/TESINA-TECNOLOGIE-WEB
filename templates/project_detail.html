{% extends "base.html" %}

{% block title %}{{ project.name }} - TaskFlow{% endblock %}

{% block content %}
<div class="page-header">
    <div>
        <a href="{{ url_for('index') }}" class="breadcrumb">‚Üê Torna ai progetti</a>
        <h1 style="border-left: 4px solid {{ project.color }}; padding-left: 15px;">{{ project.name }}</h1>
        <p>{{ project.description }}</p>
    </div>
    <a href="{{ url_for('create_task_form', project_id=project.id) }}" class="btn btn-primary">+ Nuovo Task</a>
</div>

{% if tasks %}
<div class="tasks-list">
    {% for task in tasks %}
    <div class="task-card">
        <div class="task-main">
            <div class="task-info">
                <h3>{{ task.title }}</h3>
                {% if task.description %}
                <p class="task-description">{{ task.description }}</p>
                {% endif %}
                <span class="task-date">Creato: {{ task.created_at[:10] }}</span>
            </div>

            <div class="task-badges">
                <span class="badge status-{{ task.status }}">
                    {% if task.status == 'todo' %}
                        Da Fare
                    {% elif task.status == 'in_progress' %}
                        In Corso
                    {% else %}
                        Completato
                    {% endif %}
                </span>
                <span class="badge priority-{{ task.priority }}">
                    {% if task.priority == 'low' %}
                        Bassa
                    {% elif task.priority == 'medium' %}
                        Media
                    {% else %}
                        Alta
                    {% endif %}
                </span>
            </div>
        </div>

        <div class="task-actions">
            {% if task.status == 'todo' %}
            <a href="{{ url_for('update_task_status', task_id=task.id, new_status='in_progress', project_id=project.id) }}"
               class="btn btn-small">
                ‚ñ∂Ô∏è Inizia
            </a>
            {% elif task.status == 'in_progress' %}
            <a href="{{ url_for('update_task_status', task_id=task.id, new_status='done', project_id=project.id) }}"
               class="btn btn-small btn-success">
                ‚úì Completa
            </a>
            {% endif %}

            <a href="{{ url_for('delete_task', task_id=task.id, project_id=project.id) }}"
               class="btn btn-small btn-danger"
               onclick="return confirm('Sei sicuro di voler eliminare questo task?')"
               title="Elimina">
                üóëÔ∏è
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <h2>Nessun Task</h2>
    <p>Non ci sono ancora task in questo progetto. Crea il primo!</p>
    <a href="{{ url_for('create_task_form', project_id=project.id) }}" class="btn btn-primary">Crea Task</a>
</div>
{% endif %}
{% endblock %}
